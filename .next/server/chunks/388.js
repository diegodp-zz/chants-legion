exports.id=388,exports.ids=[388],exports.modules={3928:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},46:()=>{},7190:(e,s,t)=>{"use strict";t.d(s,{V:()=>x});var n=t(326),r=t(7577),a=t(1129),l=t(2177),i=t(4840);function d(){let{sendName:e,thisUser:s}=(0,a.U)(),[t,l]=(0,r.useState)("");return(0,n.jsxs)("div",{className:"form flex flex-row",children:[n.jsx("input",{value:t,onChange:e=>l(e.target.value),type:"text",placeholder:"User Name",className:"input input-bordered w-full max-w-xs rounded-2xl mr-2 text-sm input-primary"}),n.jsx("button",{className:"btn btn-primary rounded-2xl",disabled:!s||""===t,onClick:()=>{l(""),e(t)},children:"Change Name"})]})}let o=()=>{let{sendIsTyping:e,sendMessage:s,usersWhoAreTyping:t}=(0,l.U)(),{thisUser:o}=(0,a.U)(),[u,c]=(0,r.useState)(null),m=(0,i.Nr)(u,3e3);(0,r.useEffect)(()=>{o&&(c(null),e(o,!1))},[e,o,m]);let[x,h]=(0,r.useState)("");return(0,n.jsxs)("div",{className:"chat-form",children:[n.jsx("textarea",{placeholder:"Type a message...",value:x,onChange:s=>{o&&(e(o,!0),c(new Date().getTime())),h(s.target.value)},className:"textarea textarea-bordered w-full resize-none rounded-2xl mb-2 textarea-primary"}),(0,n.jsxs)("div",{className:"flex flex-row justify-between space-x-2",children:[n.jsx("button",{className:"btn btn-primary rounded-2xl flex-grow",disabled:!o||""===x.trim(),onClick:()=>{o&&(s(o,x),h(""),e(o,!1))},children:"Send Message"}),n.jsx(d,{})]})]})},u=()=>{let{chatMessages:e}=(0,l.U)(),{users:s}=(0,a.U)(),[t,i]=(0,r.useState)([]);(0,r.useEffect)(()=>{e&&i(s=>[...s,...e])},[e]);let d=t?.map(({id:e,text:t})=>{let n=s.find(s=>s.id===e);return n?.name?`${n.name}: ${t}`:`${e}: ${t}`}).join("\n");return n.jsx("textarea",{className:"textarea textarea-bordered w-full flex-1 resize-none rounded-2xl textarea-primary overflow-visible",readOnly:!0,value:d,onChange:()=>{}},JSON.stringify(t))};function c(){let{usersWhoAreTyping:e}=(0,l.U)(),{thisUser:s,users:t}=(0,a.U)(),r=e.filter(e=>s!==e),i=r.length>0,d=null;return i&&(d=r.reduce((e,s)=>{""!==e&&(e+=", ");let n=t.find(e=>e.id===s);return n?.name?e+=n.name:e+=s,e},""),1===r.length?d+=" is typing":r.length>1&&(d+=" are typing")),n.jsx("div",{className:"h-[26.5px]",children:(0,n.jsxs)("div",{children:[i?n.jsx("div",{className:"loading loading-dots loading-sm top-1 relative mr-2"}):null,d]})})}function m(){let{thisUser:e,users:s}=(0,a.U)(),t=s.find(s=>s.id===e),r=s.reduce((s,t)=>(t.id===e||(""!==s&&(s+=", "),t.name?s+=t.name:s+=t.id),s),"");return(0,n.jsxs)("div",{className:"connected-users",children:["Users: (",s.length,") ",r,0!==r.length?", ":"",n.jsx("span",{className:"text-green-600",children:t?.name?t.name:t?.id})]})}let x=({room:e})=>(0,n.jsxs)("div",{className:"flex flex-col w-full h-full",children:[n.jsx("div",{className:"form-control flex-1",children:(0,n.jsxs)("div",{className:"flex-1 flex flex-col",children:[n.jsx(m,{}),n.jsx(u,{})]})}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-2 mt-2",children:[n.jsx(c,{}),n.jsx(o,{})]})]})},2177:(e,s,t)=>{"use strict";t.d(s,{x:()=>o,U:()=>u});var n=t(326),r=t(7577),a=t(2096);let l={isTyping:"isTyping",newMessage:"newMessage",messages:"messages"};({...a.v});var i=t(9921);let d=r.createContext(void 0);function o({children:e}){let{sendJson:s}=(0,i.sV)(),[t,a]=(0,r.useState)([]),[o,u]=(0,r.useState)([]);(0,i.I8)(e=>{a([e])},l.newMessage),(0,i.I8)(u,l.isTyping),(0,i.I8)(a,l.messages);let c=(0,r.useCallback)((e,t)=>{s({newMessage:{id:e,text:t}})},[s]),m=(0,r.useCallback)((e,t)=>{t?s({isTyping:e}):s({isNotTyping:e})},[s]);return n.jsx(d.Provider,{value:{chatMessages:t,sendMessage:c,sendIsTyping:m,usersWhoAreTyping:o},children:e})}function u(){let e=r.useContext(d);if(void 0===e)throw Error("useSocketMessage must be used within a MessageProvider");return e}},9921:(e,s,t)=>{"use strict";t.d(s,{I8:()=>o,sV:()=>d,wP:()=>i});var n=t(326),r=t(7577),a=t(3894);let l=r.createContext(void 0);function i({children:e,room:s}){let[t,i]=(0,r.useState)({}),d=(0,a.Z)({host:"localhost:1999",room:s,onClose(){},onMessage(e){i(JSON.parse(e.data))}}),o=(0,r.useCallback)(e=>{d.send(JSON.stringify(e))},[d]);return n.jsx(l.Provider,{value:{messages:t,setMessages:i,sendJson:o},children:e})}function d(){let e=r.useContext(l);if(void 0===e)throw Error("useSocket must be used within a SocketProvider");return e}function o(e,s){let{messages:t,setMessages:n}=d();t[s]}},1129:(e,s,t)=>{"use strict";t.d(s,{K:()=>u,U:()=>c});var n=t(326),r=t(7577),a=t(9921),l=t(2096);let i={nameChanged:"nameChanged",newUser:"newUser",removeUser:"removeUser",userId:"userId",users:"users"};({...l.v});var d=t(4840);let o=r.createContext(void 0);function u({children:e}){let{sendJson:s}=(0,a.sV)(),[t,l]=(0,r.useState)([]),[u,c]=(0,r.useState)(null);return(0,d.KS)(()=>{if(!u)throw Error("Could not get the current user id?")},3e3),(0,a.I8)(c,i.userId),(0,a.I8)(l,i.users),(0,a.I8)(e=>{l(s=>[...s,e])},i.newUser),(0,a.I8)(e=>{l(s=>s.filter(s=>s.id!==e))},i.removeUser),(0,a.I8)(e=>{l(s=>s.map(s=>s.id===e.id&&e.name?{...s,name:e.name}:s))},i.nameChanged),n.jsx(o.Provider,{value:{thisUser:u,users:t,sendName:e=>s({changeName:e})},children:e})}function c(){let e=r.useContext(o);if(void 0===e)throw Error("useUsers must be used within a UsersProvider");return e}},2096:(e,s,t)=>{"use strict";function n(e){this.send(JSON.stringify(e))}function r(e,s){this.broadcast(JSON.stringify(e),s)}t.d(s,{v:()=>a});let a={onConnect(e,s){e.sendJson=n,s.broadcastJson=r,this.onConnectExtended(e,s)},onClose(e,s){e.sendJson=n,s.broadcastJson=r,this.onCloseExtended(e,s)},onMessage(e,s,t){s.sendJson=n,t.broadcastJson=r,this.onMessageExtended(e,s,t)},onMessageExtended(e,s,t){},onConnectExtended(e,s){},onCloseExtended(e,s){}}},2029:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i,metadata:()=>l});var n=t(9510),r=t(5317),a=t.n(r);t(5023);let l={title:"PartyKit Chat Demo",description:"Chat!"};function i({children:e}){return n.jsx("html",{"data-theme":"light",lang:"en",children:n.jsx("body",{className:a().className,children:e})})}},3881:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});var n=t(6621);let r=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,n.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},5023:()=>{}};